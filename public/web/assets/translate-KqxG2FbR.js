import{a as A,_ as U,r as y,o as j,c as R,b as g,w as h,F as z,d as V,e as b}from"./index-wLCuO0ZO.js";class J{constructor(l=-1,t="无法连接服务器",o={}){this.state=l===void 0?-1:l,this.msg=t===void 0?"":t,this.data=o===void 0?{}:o}reBuild(l,t,o){this.state=l===void 0?-1:l,this.msg=t===void 0?"":t,this.data=o===void 0?{}:o}isErr(){return this.state!==0}}async function L(e,l){const t=JSON.stringify(l),o={method:"post",url:e,headers:{"Content-Type":"application/json"},data:t};let n=new J;try{await A(o).then(function(a){n.reBuild(a.data.state,a.data.msg,a.data.data)}).catch(function(a){console.log(a)})}catch(a){console.log(a)}return n}function F(e){const l=[];return e.forEach(function(t){l.push({lang_name:t.lang_name,lang_file:t.lang_file,lang:JSON.stringify(t.lang,null,2)})}),l}function K(e,l){const t=newUploadLangFilePara(e,l);return L("/uploadLang",t)}function O(e){const l=F(e);return L("/saveLangList",l)}function M(e){return new Promise(l=>setTimeout(l,e))}function D(){return{main_lang:_("","",""),sub_lang:[_("","","")]}}function _(e,l,t){return{lang_name:e,lang_file:l,lang:H(t,{})}}function H(e,l){try{return JSON.parse(e)}catch{return l}}async function T(){const e={},l="/getLangInfo",t=D();return await L(l,e).then(async function(o){if(o.isErr())return console.log(o.msg),await M(1e3),T();t.main_lang=_(o.data.main_lang.lang_name,o.data.main_lang.lang_file,o.data.main_lang.lang),t.sub_lang=[];for(let n=0;n<o.data.sub_lang.length;n++){const a=o.data.sub_lang[n];t.sub_lang.push(_(a.lang_name,a.lang_file,a.lang))}return t})}function q(e,l,t,o,n,a){let i=document.createElement("table");i.style.borderCollapse="collapse",i.style.align="center";let r=Z(e,l,t,n);i.appendChild(r);const d=X(t,n,a);i.appendChild(d),o.appendChild(i)}function C(e,l){return e===void 0||e===l}function Z(e,l,t,o){const n=ae(),a=1+(C(t.main_lang.lang_name,"")?0:1)+t.sub_lang.length,i=G(e,l,a);n.appendChild(i);const r=Q(t,l,o);return n.appendChild(r),n}function G(e,l,t){let o=document.createElement("tr"),n=I();n.colSpan=t;let a=x();return a.textContent="重新加载",a.addEventListener("click",function(){e()}),n.appendChild(a),a=x(),a.textContent="保存全部",a.addEventListener("click",function(){l([])}),n.appendChild(a),o.appendChild(n),o}function Q(e,l,t){const o=document.createElement("tr");let n=ie(e.main_lang.lang,t);if(o.appendChild(n),!C(e.main_lang.lang_name)&&(n=E(e.main_lang,l),o.appendChild(n),!C(e.sub_lang)))return e.sub_lang.forEach(function(a){n=E(a,l),o.appendChild(n)}),o}function E(e,l){const t=I();t.textContent=e.lang_name;let o=x();return o.textContent="保存",o.addEventListener("click",function(){const n=[];n.push(e),l(n)}),t.appendChild(o),o=x(),o.textContent="导出",o.addEventListener("click",function(){$(e.lang,e.lang_file)}),t.appendChild(o),t}function X(e,l,t){const o=document.createElement("tbody");let n=[];for(let a=0;a<e.sub_lang.length;a++)n.push(e.sub_lang[a].lang);return P("",e.main_lang.lang,n,o,l,t),o}function P(e,l,t,o,n,a){if(!C(l,{}))for(const i in l){let r=l[i],d=[],s=v(r);for(const p in t){t[p][i]===void 0&&(t[p][i]=k(r));let f=v(t[p][i]);f>s&&(s=f),d.push(t[p][i])}const u=document.createElement("tr"),c=function(){a(l,i)};if(typeof r!="object"){const p=te(e+i,c);u.appendChild(p);const m=w(r,s,r,function(f){l[i]=f});u.appendChild(m);for(const f in d){const N=w(d[f],s,r,function(W){t[f][i]=W});u.appendChild(N)}o.appendChild(u)}else{const p=function(){n(r)},m=ee(e+i,p,c);m.colSpan=2+d.length,u.appendChild(m),o.appendChild(u),P(e+i+".",r,d,o,n,a)}}}function Y(e,l){for(const t in l){let o=S(e,l[t]);l[t]=o}}function S(e,l){let t={};for(const o in e){let n=l[o];n===void 0?t[o]=k(e[o]):(typeof n=="object"&&(n=S(e[o],l[o])),t[o]=n)}return t}function $(e,l){let t=JSON.stringify(e,null,2),o=new Blob([t],{type:"application/javascript"}),n=document.createElement("a");n.href=URL.createObjectURL(o),n.download=l,n.click()}function ee(e,l,t){const o=B(),n=document.createElement("label");if(n.textContent=e,n.style.fontWeight="bold",o.appendChild(n),/[\u4e00-\u9fa5]/.test(e)!==!0){var a=document.createElement("button");a.textContent="+",a.style.marginLeft="10px",a.addEventListener("click",function(){l()}),o.appendChild(a)}return a=document.createElement("button"),a.textContent="del",a.style.color="red",a.style.marginLeft="10px",a.addEventListener("click",function(){t()}),o.appendChild(a),o}function te(e,l){const t=B();t.style.textAlign="";const o=document.createElement("label");o.id=e,o.textContent=e,o.style.fontWeight="bold",t.appendChild(o),n=document.createElement("button"),n.style.float="right",n.style.color="red",n.style.marginLeft="5px",n.textContent="del",n.addEventListener("click",function(){l()}),t.appendChild(n);var n=document.createElement("button");return n.style.float="right",n.textContent="`",n.addEventListener("click",function(){navigator.clipboard.writeText("`${this.$t('"+e+"')}`")}),t.appendChild(n),n=document.createElement("button"),n.style.float="right",n.textContent="{",n.addEventListener("click",function(){navigator.clipboard.writeText("{{$t('"+e+"')}}")}),t.appendChild(n),n=document.createElement("button"),n.style.float="right",n.textContent="t",n.addEventListener("click",function(){navigator.clipboard.writeText("this.$t('"+e+"')")}),t.appendChild(n),n=document.createElement("button"),n.style.float="right",n.textContent="$",n.addEventListener("click",function(){navigator.clipboard.writeText("$t('"+e+"')")}),t.appendChild(n),n=document.createElement("button"),n.style.float="right",n.textContent="c",n.addEventListener("click",function(){navigator.clipboard.writeText(e)}),t.appendChild(n),t}function w(e,l,t,o){const n=ne(),a=oe(l,n);return a.value=e,a.placeholder=t,a.addEventListener("input",function(){o(a.value)}),n.appendChild(a),n}function ne(){const e=document.createElement("td");return e.style.border="1px solid",e.style.minWidth="300px",e.style.paddingTop="0px",e.style.paddingBottom="0px",e.style.paddingLeft="3px",e.style.paddingRight="3px",e}function v(e){if(typeof e!="string")return 0;const l=16.66666,t=8,o=8;for(var n=0,a=0,i=0,r=0;r<e.length;r++){var d=e.charAt(r);/[\u4e00-\u9fa5]/.test(d)?n++:/[a-zA-Z]/.test(d)?a++:i++}return l*n+t*a+o*i}function le(e){let l=Math.ceil(e/300);return l===0?1:l}function oe(e,l){const t=document.createElement("textarea");return t.style.width="100%",t.style.height="100%",t.style.boxSizing="border-box",t.style.minHeight="25px",t.style.fontSize="16px",t.style.verticalAlign="middle",t.rows=le(e),t.style.outline="none",t.style.border="none",t.style.resize="vertical",t.addEventListener("focus",function(){t.style.background="#e1e1e1",l.style.background="#e1e1e1"}),t.addEventListener("blur",function(){t.style.background="#ffffff",l.style.background="#ffffff"}),t}function ae(){const e=document.createElement("thead");return e.style.top="0",e.style.position="sticky",e}function I(){let e=document.createElement("th");return e.style.fontWeight="bolder",e.style.textAlign="center",e.style.border="1px solid",e.style.background="#c1e2f8",e.style.minWidth="200px",e.style.height="40px",e}function ie(e,l){let t=document.createElement("th");t.style.fontWeight="bolder",t.style.textAlign="center",t.style.border="1px solid",t.style.background="#c1e2f8",t.style.minWidth="200px",t.style.height="40px";const o=document.createElement("label");o.textContent="Key 值",o.style.fontWeight="bold",t.appendChild(o);var n=document.createElement("button");return n.textContent="+",n.style.marginLeft="10px",n.addEventListener("click",function(){l(e)}),t.appendChild(n),t}function x(){let e=document.createElement("button");return e.style.marginLeft="5px",e}function B(){const e=document.createElement("td");return e.style.fontWeight="bolder",e.style.textAlign="center",e.style.border="1px solid",e.style.background="#f2fbfe",e.style.minWidth="200px",e}function k(e){if(typeof e!="object")return e;let l={};for(const t in e)l[t]=k(e[t]);return l}const re={data(){return{langInfo:{},dialogVisible:!1,input_key:"",nowParent:{},add_key_type:"1"}},watch:{langInfo(e,l){this.buildView()}},mounted(){this.getLang(!1)},methods:{updateLang(){this.getLang(!0)},saveLang(e){console.log("save lang list"),Y(this.langInfo.main_lang,this.langInfo.sub_lang),e.length===0&&(e.push(this.langInfo.main_lang),this.langInfo.sub_lang.forEach(l=>{e.push(l)})),O(e).then(l=>{alert(l.msg)})},getLang(e){T().then(l=>{this.langInfo=l}).catch(l=>{console.log(l)})},buildView(){if(this.langInfo===void 0)return;const e=document.getElementById("tableCreator");e.innerHTML="",q(this.updateLang,this.saveLang,this.langInfo,e,this.addKey,this.delKey)},UploadLang(e,l){K(e,l).then(t=>{alert(t.msg)})},addKey(e){this.nowParent=e,this.dialogVisible=!0},delKey(e,l){delete e[l],this.buildView()},addNewKey(e){if(console.log(e,this.nowParent),e==="")alert("key不能为空");else{for(const l in this.nowParent)if(e===l){alert("key已存在");return}this.add_key_type==="1"?this.nowParent[e]="":this.nowParent[e]={},this.buildView()}}}},de=V("div",{id:"tableCreator"},null,-1),ce={style:{width:"30%","text-align":"center"}};function se(e,l,t,o,n,a){const i=y("el-radio"),r=y("el-radio-group"),d=y("el-input"),s=y("el-button"),u=y("el-dialog");return j(),R(z,null,[de,g(u,{modelValue:n.dialogVisible,"onUpdate:modelValue":l[4]||(l[4]=c=>n.dialogVisible=c),title:"添加key",width:"30%",center:""},{footer:h(()=>[g(s,{onClick:l[2]||(l[2]=c=>{n.dialogVisible=!1,n.nowParent={},n.input_key=""})},{default:h(()=>[b("取消")]),_:1}),g(s,{type:"primary",onClick:l[3]||(l[3]=c=>{n.dialogVisible=!1,a.addNewKey(n.input_key),n.input_key=""})},{default:h(()=>[b(" 确认 ")]),_:1})]),default:h(()=>[V("span",ce,[g(r,{modelValue:n.add_key_type,"onUpdate:modelValue":l[0]||(l[0]=c=>n.add_key_type=c),class:"ml-4"},{default:h(()=>[g(i,{label:"1",size:"large"},{default:h(()=>[b("key-值")]),_:1}),g(i,{label:"2",size:"large"},{default:h(()=>[b("key-类")]),_:1})]),_:1},8,["modelValue"]),g(d,{modelValue:n.input_key,"onUpdate:modelValue":l[1]||(l[1]=c=>n.input_key=c),placeholder:"输入key"},null,8,["modelValue"])])]),_:1},8,["modelValue"])],64)}const pe=U(re,[["render",se]]);export{pe as default};
